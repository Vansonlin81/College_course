{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1m1-UnA7EUWogxrDj0dVTayKAOzCSofae","timestamp":1684135824511}]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"66c849cd5c5f4146b3ed7a8c88a1ebe0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_66c06a72560a482a875b7295d27430dd","IPY_MODEL_8653ebb30d3e4b7699de8250caeffd58","IPY_MODEL_5b61c7ce06de4f90961e5f932314b5fd"],"layout":"IPY_MODEL_ab916be5c3664c9187301ce02036b7af"}},"66c06a72560a482a875b7295d27430dd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_12b8f04f19894252948a9bf455bba047","placeholder":"​","style":"IPY_MODEL_1fa85dca9de440b095cc5cbfd6ce3ab7","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"8653ebb30d3e4b7699de8250caeffd58":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2d3efd9ea8b4e02bb7c28237153fd6f","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_558720ad3f1d48be987d0bf4b33f40bd","value":231508}},"5b61c7ce06de4f90961e5f932314b5fd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0e180b9d6265432e934ef5eef14f9c6a","placeholder":"​","style":"IPY_MODEL_fbe70923855f4b89b083957d51fd664d","value":" 232k/232k [00:00&lt;00:00, 3.26MB/s]"}},"ab916be5c3664c9187301ce02036b7af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"12b8f04f19894252948a9bf455bba047":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1fa85dca9de440b095cc5cbfd6ce3ab7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d2d3efd9ea8b4e02bb7c28237153fd6f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"558720ad3f1d48be987d0bf4b33f40bd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0e180b9d6265432e934ef5eef14f9c6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fbe70923855f4b89b083957d51fd664d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"264c3a7a211b4b0289a6610dd8c0ebc3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_32ff653f0cfb43529a134f5e2f7def8d","IPY_MODEL_941a1c5cd74546dba3c513d81bb02282","IPY_MODEL_c686da2b8c2f492d8eb26da1a003dadc"],"layout":"IPY_MODEL_ae5fa43dd4654c49b9dfcf48013218b9"}},"32ff653f0cfb43529a134f5e2f7def8d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8975428cee834a1a8b0ac90195aed2a9","placeholder":"​","style":"IPY_MODEL_730933c46607458fb37b7650f71111b5","value":"Downloading (…)okenizer_config.json: 100%"}},"941a1c5cd74546dba3c513d81bb02282":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0f8d817e9cdb42e99790c4cb257c4326","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_55cce42100664fc8af5ca67bfc5ec299","value":28}},"c686da2b8c2f492d8eb26da1a003dadc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0e99f31f496d4758af34d164884552ce","placeholder":"​","style":"IPY_MODEL_ccd499d2f9d84d08ae623973d5dfb7c9","value":" 28.0/28.0 [00:00&lt;00:00, 1.15kB/s]"}},"ae5fa43dd4654c49b9dfcf48013218b9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8975428cee834a1a8b0ac90195aed2a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"730933c46607458fb37b7650f71111b5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0f8d817e9cdb42e99790c4cb257c4326":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"55cce42100664fc8af5ca67bfc5ec299":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0e99f31f496d4758af34d164884552ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ccd499d2f9d84d08ae623973d5dfb7c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"925c732426c042919f07734578deffdf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_043320079fad4cbf9c393f6fe4ce8c2b","IPY_MODEL_0fb26417eb9647d4ad1dcf79062204a2","IPY_MODEL_693496fbe98f44039b2fc77ab65deb3f"],"layout":"IPY_MODEL_cb875b70cf1949fb82caca160f85672d"}},"043320079fad4cbf9c393f6fe4ce8c2b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8a38be7a40b6485889452a2e795cffea","placeholder":"​","style":"IPY_MODEL_eafdd432a270404da43da408d4ce3ddc","value":"Downloading (…)lve/main/config.json: 100%"}},"0fb26417eb9647d4ad1dcf79062204a2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_13112f65319b4f3c9b5cf8a65d819c3c","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_de5a7bd80d4d44e6987475bc813af97d","value":570}},"693496fbe98f44039b2fc77ab65deb3f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_71a74f464c624489866bdee050e2e542","placeholder":"​","style":"IPY_MODEL_85c321c52e084d4fb4318867cb206cb2","value":" 570/570 [00:00&lt;00:00, 23.3kB/s]"}},"cb875b70cf1949fb82caca160f85672d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8a38be7a40b6485889452a2e795cffea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eafdd432a270404da43da408d4ce3ddc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"13112f65319b4f3c9b5cf8a65d819c3c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de5a7bd80d4d44e6987475bc813af97d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"71a74f464c624489866bdee050e2e542":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"85c321c52e084d4fb4318867cb206cb2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"19cc58bda99846efa68fdf97fdedebb4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_15c749118a444912a4b7a8c823df4784","IPY_MODEL_c438e261b91f46dbbbe74548b111805a","IPY_MODEL_1dc96c61eba343c9a4ce8a0dd4958072"],"layout":"IPY_MODEL_605c4ddb9d3749bba7c567eeb737a44c"}},"15c749118a444912a4b7a8c823df4784":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c5d71819c14847c7b06f8be44a32afa7","placeholder":"​","style":"IPY_MODEL_ba8b065239f34e2ca86934e42f3b0804","value":"Downloading pytorch_model.bin: 100%"}},"c438e261b91f46dbbbe74548b111805a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ab6503298384d5691547e8cfbb6c943","max":440473133,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0422171feecb4b498ffe417275edc7f4","value":440473133}},"1dc96c61eba343c9a4ce8a0dd4958072":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ddb68c5b3ab3456aa5291a35b526b865","placeholder":"​","style":"IPY_MODEL_b475cb17b84e45ac8a932ddf603ba9bd","value":" 440M/440M [00:02&lt;00:00, 169MB/s]"}},"605c4ddb9d3749bba7c567eeb737a44c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c5d71819c14847c7b06f8be44a32afa7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ba8b065239f34e2ca86934e42f3b0804":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ab6503298384d5691547e8cfbb6c943":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0422171feecb4b498ffe417275edc7f4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ddb68c5b3ab3456aa5291a35b526b865":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b475cb17b84e45ac8a932ddf603ba9bd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"32f335bb67e545cb9f085db7fdaaa798":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c9df54ca00f147df8c79415644c99def","IPY_MODEL_c08061bcaac14fcaa8bf52245883bd32","IPY_MODEL_f682112ebad54104991eb7b0120a6516"],"layout":"IPY_MODEL_626316d8518b4ffeb615d27acdff2f30"}},"c9df54ca00f147df8c79415644c99def":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3d93f65256ab44d4ae61a66c1ecb8d54","placeholder":"​","style":"IPY_MODEL_0d14c7b22b2a432889e145e2cb3a2f2f","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"c08061bcaac14fcaa8bf52245883bd32":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_da7b4a48901f42c7b741318705dcdebf","max":109540,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a4e3e378641e4cedb2ed67ba80a7b44b","value":109540}},"f682112ebad54104991eb7b0120a6516":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8ff28fc16c804f53ab90510c39f29a6c","placeholder":"​","style":"IPY_MODEL_4114c413f50e4b55add01464320e7151","value":" 110k/110k [00:00&lt;00:00, 1.69MB/s]"}},"626316d8518b4ffeb615d27acdff2f30":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3d93f65256ab44d4ae61a66c1ecb8d54":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0d14c7b22b2a432889e145e2cb3a2f2f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"da7b4a48901f42c7b741318705dcdebf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a4e3e378641e4cedb2ed67ba80a7b44b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8ff28fc16c804f53ab90510c39f29a6c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4114c413f50e4b55add01464320e7151":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3ecf9d6773df4c04b8c3d125d1594550":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_494a7efd8f3649cd9cd6567cb99c9812","IPY_MODEL_9000b04c2f9141d3ac994aa1e475801b","IPY_MODEL_2627693412c24da6ade2fe26409c370d"],"layout":"IPY_MODEL_c2a1e84527a746d18be72230685fa282"}},"494a7efd8f3649cd9cd6567cb99c9812":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5517cd26b139435abf0109f27667ee58","placeholder":"​","style":"IPY_MODEL_6dc4566fbcf54e84b6d81cb03f37fe73","value":"Downloading (…)okenizer_config.json: 100%"}},"9000b04c2f9141d3ac994aa1e475801b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4cf98f1113cd41a1ae50dcf225c230ef","max":29,"min":0,"orientation":"horizontal","style":"IPY_MODEL_135073c6694d4e33b728c603646a9441","value":29}},"2627693412c24da6ade2fe26409c370d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4b78006bcc104fecbba1aa96cc0f043d","placeholder":"​","style":"IPY_MODEL_8b3fd42ab5824e9b955e5f2b62a06356","value":" 29.0/29.0 [00:00&lt;00:00, 957B/s]"}},"c2a1e84527a746d18be72230685fa282":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5517cd26b139435abf0109f27667ee58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6dc4566fbcf54e84b6d81cb03f37fe73":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4cf98f1113cd41a1ae50dcf225c230ef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"135073c6694d4e33b728c603646a9441":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4b78006bcc104fecbba1aa96cc0f043d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8b3fd42ab5824e9b955e5f2b62a06356":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d0ecff3ed2684b35924b24ad5a511959":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6b472daf013b40db8460dd1eb38a8da3","IPY_MODEL_c78dd58180444e4bb8d2b18942436cac","IPY_MODEL_c92a9d2cc76a455197bb9b0acd57a62d"],"layout":"IPY_MODEL_91bfd6b5d3b74571a8bc91615a2de3ee"}},"6b472daf013b40db8460dd1eb38a8da3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_937fd255686049bebf07b94bb3c16c79","placeholder":"​","style":"IPY_MODEL_2c67f8b0fba7415598b34ccf080c0424","value":"Downloading (…)lve/main/config.json: 100%"}},"c78dd58180444e4bb8d2b18942436cac":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a0dcdfa987f43d49c8585a1a4542b96","max":624,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9ee55d6b92a44b238d243c04bfb05347","value":624}},"c92a9d2cc76a455197bb9b0acd57a62d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5cfb5b7902174ba7a78df2a43981b089","placeholder":"​","style":"IPY_MODEL_fc4d29cb1a094078aec62045774c60a7","value":" 624/624 [00:00&lt;00:00, 22.1kB/s]"}},"91bfd6b5d3b74571a8bc91615a2de3ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"937fd255686049bebf07b94bb3c16c79":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2c67f8b0fba7415598b34ccf080c0424":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6a0dcdfa987f43d49c8585a1a4542b96":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9ee55d6b92a44b238d243c04bfb05347":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5cfb5b7902174ba7a78df2a43981b089":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fc4d29cb1a094078aec62045774c60a7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d3435f0ba0b1461cab152863c0588715":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d95bd162459744f7b6d2417ae6702693","IPY_MODEL_bc38fc2aa9b940c48eef66b509e8d142","IPY_MODEL_3586ae009344493aadb98eb91a78ba21"],"layout":"IPY_MODEL_4fe9d4cc3d29457199639979f202df1a"}},"d95bd162459744f7b6d2417ae6702693":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8bca5fd8f55e451e992878e7dc08247e","placeholder":"​","style":"IPY_MODEL_94f97a6bd76b47ef8e30c9f8aeb87116","value":"Downloading pytorch_model.bin: 100%"}},"bc38fc2aa9b940c48eef66b509e8d142":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_34d3d25536d241ca99ac45b21daf0b8b","max":411577189,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f980bc18cd8b4c2eb13555e6c23c1e9c","value":411577189}},"3586ae009344493aadb98eb91a78ba21":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a9da7f0b0394d3ab473bb16dbc06be2","placeholder":"​","style":"IPY_MODEL_1955ec15145240849b8f3a13a3942b02","value":" 412M/412M [00:03&lt;00:00, 156MB/s]"}},"4fe9d4cc3d29457199639979f202df1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8bca5fd8f55e451e992878e7dc08247e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"94f97a6bd76b47ef8e30c9f8aeb87116":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34d3d25536d241ca99ac45b21daf0b8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f980bc18cd8b4c2eb13555e6c23c1e9c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2a9da7f0b0394d3ab473bb16dbc06be2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1955ec15145240849b8f3a13a3942b02":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# 範例程式 -- 使用　BERT　預訓練模型\n"],"metadata":{"id":"azNxVUOMgxjL"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"wVBBJMbZgLWy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136009310,"user_tz":-480,"elapsed":24522,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"87eb4bb0-3a03-4514-b696-e5046e954a0f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.29.1-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m25.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m11.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m22.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.14.1 tokenizers-0.13.3 transformers-4.29.1\n"]}],"source":["!pip install transformers"]},{"cell_type":"code","source":["import torch\n","from transformers import BertTokenizer, BertModel\n","\n","import matplotlib.pyplot as plt\n","%matplotlib inline\n","\n","USE_PRETRAINED = 'bert-base-uncased'\n","# 有這些 pretrained 可以用用看\n","#'bert-base-chinese'        #'hfl/chinese-roberta-wwm-ext-large'    #'bert-base-uncased'\n"],"metadata":{"id":"ft7SXGAYhKOt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 研究取出 word embeddings\n","# functions\n","def bert_text_preparation(text, tokenizer):\n","    \"\"\"Preparing the input for BERT\n","    \n","    Takes a string argument and performs\n","    pre-processing like adding special tokens,\n","    tokenization, tokens to ids, and tokens to\n","    segment ids. All tokens are mapped to seg-\n","    ment id = 1.\n","    \n","    Args:\n","        text (str): Text to be converted\n","        tokenizer (obj): Tokenizer object\n","            to convert text into BERT-re-\n","            adable tokens and ids\n","        \n","    Returns:\n","        list: List of BERT-readable tokens\n","        obj: Torch tensor with token ids\n","        obj: Torch tensor segment ids\n","    \n","    \n","    \"\"\"\n","    marked_text = \"[CLS] \" + text + \" [SEP]\"\n","    tokenized_text = tokenizer.tokenize(marked_text)\n","    indexed_tokens = tokenizer.convert_tokens_to_ids(tokenized_text)\n","    segments_ids = [1]*len(indexed_tokens)\n","\n","    # Convert inputs to PyTorch tensors\n","    tokens_tensor = torch.tensor([indexed_tokens])\n","    segments_tensors = torch.tensor([segments_ids])\n","\n","    return tokenized_text, tokens_tensor, segments_tensors\n","\n","def get_bert_embeddings(tokens_tensor, segments_tensors, model):\n","    \"\"\"Get embeddings from an embedding model\n","    \n","    Args:\n","        tokens_tensor (obj): Torch tensor size [n_tokens]\n","            with token ids for each token in text\n","        segments_tensors (obj): Torch tensor size [n_tokens]\n","            with segment ids for each token in text\n","        model (obj): Embedding model to generate embeddings\n","            from token and segment ids\n","    \n","    Returns:\n","        list: List of list of floats of size\n","            [n_tokens, n_embedding_dimensions]\n","            containing embeddings for each token\n","    \n","    \"\"\"\n","    \n","    model.eval()\n","\n","    # Run the text through BERT, and collect all of the hidden states produced\n","    # from all 12 layers. \n","    with torch.no_grad():\n","        outputs = model(tokens_tensor, segments_tensors)\n","\n","        # Evaluating the model will return a different number of objects based on \n","        # how it's  configured in the `from_pretrained` call earlier. In this case, \n","        # becase we set `output_hidden_states = True`, the third item will be the \n","        # hidden states from all layers. See the documentation for more details:\n","        # https://huggingface.co/transformers/model_doc/bert.html#bertmodel\n","        hidden_states = outputs[2]\n","\n","        # Concatenate the tensors for all layers. We use `stack` here to\n","        # create a new dimension in the tensor.\n","        token_embeddings = torch.stack(hidden_states, dim=0)\n","\n","        #print(token_embeddings.size())\n","        # Remove dimension 1, the \"batches\".\n","        token_embeddings = torch.squeeze(token_embeddings, dim=1)\n","\n","        #print(token_embeddings.size())\n","\n","        # Swap dimensions 0 and 1.\n","        token_embeddings = token_embeddings.permute(1,0,2)\n","\n","        print(token_embeddings.size())\n","        return token_embeddings"],"metadata":{"id":"mv0T9HWhh0jd"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from scipy.spatial.distance import cosine\n","help(cosine)"],"metadata":{"id":"HNJfT0NSg6ff","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136233261,"user_tz":-480,"elapsed":310,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"f6f8e866-b4e7-4c89-939d-e614c351a130"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Help on function cosine in module scipy.spatial.distance:\n","\n","cosine(u, v, w=None)\n","    Compute the Cosine distance between 1-D arrays.\n","    \n","    The Cosine distance between `u` and `v`, is defined as\n","    \n","    .. math::\n","    \n","        1 - \\frac{u \\cdot v}\n","                  {\\|u\\|_2 \\|v\\|_2}.\n","    \n","    where :math:`u \\cdot v` is the dot product of :math:`u` and\n","    :math:`v`.\n","    \n","    Parameters\n","    ----------\n","    u : (N,) array_like\n","        Input array.\n","    v : (N,) array_like\n","        Input array.\n","    w : (N,) array_like, optional\n","        The weights for each value in `u` and `v`. Default is None,\n","        which gives each value a weight of 1.0\n","    \n","    Returns\n","    -------\n","    cosine : double\n","        The Cosine distance between vectors `u` and `v`.\n","    \n","    Examples\n","    --------\n","    >>> from scipy.spatial import distance\n","    >>> distance.cosine([1, 0, 0], [0, 1, 0])\n","    1.0\n","    >>> distance.cosine([100, 0, 0], [0, 1, 0])\n","    1.0\n","    >>> distance.cosine([1, 1, 0], [0, 1, 0])\n","    0.29289321881345254\n","\n"]}]},{"cell_type":"markdown","source":["## 1) 嘗試英文"],"metadata":{"id":"ck-6Mj-2rcsz"}},{"cell_type":"code","source":["# Load pre-trained model (weights)\n","# Whether the model returns all hidden-states.\n","\n","# Load pre-trained model tokenizer (vocabulary)\n","tokenizer = BertTokenizer.from_pretrained(USE_PRETRAINED)\n","model = BertModel.from_pretrained(USE_PRETRAINED, output_hidden_states = True )\n","#print(model)\n","\n","# 以下面這些字詞輸入，會看到什麼\n","# Define a new example sentence with multiple meanings of the word \"bank\"\n","text = \"After stealing money from the bank vault, the bank robber was seen \" \\\n","       \"fishing on the Mississippi river bank.\"\n","\n","# Add the special tokens.\n","marked_text = \"[CLS] \" + text + \" [SEP]\"\n","\n","# Split the sentence into tokens.\n","tokenized_text = tokenizer.tokenize(marked_text)\n","\n","# Map the token strings to their vocabulary indeces.\n","indexed_tokens = tokenizer.convert_tokens_to_ids(tokenized_text)\n","\n","# Display the words with their indeces.\n","for tup in zip(tokenized_text, indexed_tokens):\n","    print('{:<12} {:>6,}'.format(tup[0], tup[1]))\n","\n","# Mark each of the 22 tokens as belonging to sentence \"1\".\n","segments_ids = [1] * len(tokenized_text)\n","\n","print (segments_ids)\n"],"metadata":{"id":"lMlNlw22iQ7F","colab":{"base_uri":"https://localhost:8080/","height":629,"referenced_widgets":["66c849cd5c5f4146b3ed7a8c88a1ebe0","66c06a72560a482a875b7295d27430dd","8653ebb30d3e4b7699de8250caeffd58","5b61c7ce06de4f90961e5f932314b5fd","ab916be5c3664c9187301ce02036b7af","12b8f04f19894252948a9bf455bba047","1fa85dca9de440b095cc5cbfd6ce3ab7","d2d3efd9ea8b4e02bb7c28237153fd6f","558720ad3f1d48be987d0bf4b33f40bd","0e180b9d6265432e934ef5eef14f9c6a","fbe70923855f4b89b083957d51fd664d","264c3a7a211b4b0289a6610dd8c0ebc3","32ff653f0cfb43529a134f5e2f7def8d","941a1c5cd74546dba3c513d81bb02282","c686da2b8c2f492d8eb26da1a003dadc","ae5fa43dd4654c49b9dfcf48013218b9","8975428cee834a1a8b0ac90195aed2a9","730933c46607458fb37b7650f71111b5","0f8d817e9cdb42e99790c4cb257c4326","55cce42100664fc8af5ca67bfc5ec299","0e99f31f496d4758af34d164884552ce","ccd499d2f9d84d08ae623973d5dfb7c9","925c732426c042919f07734578deffdf","043320079fad4cbf9c393f6fe4ce8c2b","0fb26417eb9647d4ad1dcf79062204a2","693496fbe98f44039b2fc77ab65deb3f","cb875b70cf1949fb82caca160f85672d","8a38be7a40b6485889452a2e795cffea","eafdd432a270404da43da408d4ce3ddc","13112f65319b4f3c9b5cf8a65d819c3c","de5a7bd80d4d44e6987475bc813af97d","71a74f464c624489866bdee050e2e542","85c321c52e084d4fb4318867cb206cb2","19cc58bda99846efa68fdf97fdedebb4","15c749118a444912a4b7a8c823df4784","c438e261b91f46dbbbe74548b111805a","1dc96c61eba343c9a4ce8a0dd4958072","605c4ddb9d3749bba7c567eeb737a44c","c5d71819c14847c7b06f8be44a32afa7","ba8b065239f34e2ca86934e42f3b0804","1ab6503298384d5691547e8cfbb6c943","0422171feecb4b498ffe417275edc7f4","ddb68c5b3ab3456aa5291a35b526b865","b475cb17b84e45ac8a932ddf603ba9bd"]},"executionInfo":{"status":"ok","timestamp":1684136130668,"user_tz":-480,"elapsed":6184,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"ff624622-b85d-4f4e-b04d-da044986f8f2"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"66c849cd5c5f4146b3ed7a8c88a1ebe0"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"264c3a7a211b4b0289a6610dd8c0ebc3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"925c732426c042919f07734578deffdf"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/440M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"19cc58bda99846efa68fdf97fdedebb4"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"stream","name":"stdout","text":["[CLS]           101\n","after         2,044\n","stealing     11,065\n","money         2,769\n","from          2,013\n","the           1,996\n","bank          2,924\n","vault        11,632\n",",             1,010\n","the           1,996\n","bank          2,924\n","robber       27,307\n","was           2,001\n","seen          2,464\n","fishing       5,645\n","on            2,006\n","the           1,996\n","mississippi   5,900\n","river         2,314\n","bank          2,924\n",".             1,012\n","[SEP]           102\n","[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n"]}]},{"cell_type":"code","source":["# Convert inputs to PyTorch tensors\n","tokens_tensor = torch.tensor([indexed_tokens])\n","segments_tensors = torch.tensor([segments_ids])\n","\n","# using get_bert_embeddings()\n","the_emb = get_bert_embeddings(tokens_tensor, segments_tensors, model)\n","\n","print('First 5 vector values for each instance of \"bank\".')\n","print('')\n","print(\"bank vault   \", str(the_emb[6][:5]))\n","print(\"bank robber  \", str(the_emb[10][:5]))\n","print(\"river bank   \", str(the_emb[19][:5]))"],"metadata":{"id":"eMkxomz9o1zs","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136131165,"user_tz":-480,"elapsed":515,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"c208c074-975a-479a-905f-e47db8aa8666"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([22, 13, 768])\n","First 5 vector values for each instance of \"bank\".\n","\n","bank vault    tensor([[ 0.0769, -0.8868, -1.4263,  ..., -0.2564,  0.1044, -0.3028],\n","        [ 0.4889, -0.9305, -1.6994,  ...,  0.3170,  0.5190, -0.3194],\n","        [ 0.6347, -0.8778, -1.4754,  ...,  0.4274,  0.9031, -0.2680],\n","        [ 0.7354, -1.0055, -0.8220,  ...,  0.6163,  0.6290, -0.2190],\n","        [ 0.9006, -0.8301, -0.7964,  ...,  0.6943,  0.1900,  0.0657]])\n","bank robber   tensor([[-0.1980, -0.6339, -1.2669,  ...,  0.0976,  0.1331, -0.1557],\n","        [ 0.3089, -0.7312, -1.4188,  ...,  0.4444,  0.2891, -0.1450],\n","        [ 0.5711, -0.3844, -1.2787,  ...,  0.1461,  0.6899, -0.0266],\n","        [ 0.7628, -0.4110, -0.7670,  ...,  0.1353,  0.7534,  0.2865],\n","        [ 0.7562, -0.2673, -0.7539,  ...,  0.2842,  0.0691,  0.5982]])\n","river bank    tensor([[-0.0374, -0.6155, -1.4419,  ...,  0.0793, -0.0811, -0.3802],\n","        [ 0.6982, -0.4554, -1.7845,  ...,  0.3308,  0.0710, -0.5187],\n","        [ 0.9157, -0.4118, -1.6042,  ...,  0.1454,  0.1699, -0.2230],\n","        [ 0.9788, -0.0669, -1.6344,  ...,  0.0341,  0.0437, -0.1636],\n","        [ 1.3519,  0.3352, -1.3555,  ...,  0.1676, -0.2817,  0.1042]])\n"]}]},{"cell_type":"code","source":["from scipy.spatial.distance import cosine\n","\n","# Stores the token vectors, with shape [22 x 768]\n","token_vecs_sum = []\n","\n","# `token_embeddings` is a [22 x 12 x 768] tensor.\n","\n","# For each token in the sentence...\n","for token in the_emb:\n","\n","    # `token` is a [12 x 768] tensor\n","\n","    # Sum the vectors from the last four layers.\n","    sum_vec = torch.sum(token[-4:], dim=0)\n","    \n","    # Use `sum_vec` to represent `token`.\n","    token_vecs_sum.append(sum_vec)\n","\n","print(token_vecs_sum[6].size())\n","\n","# Calculate the cosine similarity between the word bank \n","# in \"bank robber\" vs \"river bank\" (different meanings).\n","diff_bank = 1 - cosine(token_vecs_sum[10], token_vecs_sum[19])\n","\n","# Calculate the cosine similarity between the word bank\n","# in \"bank robber\" vs \"bank vault\" (same meaning).\n","same_bank = 1 - cosine(token_vecs_sum[10], token_vecs_sum[6])\n","\n","# index of \"bank\" vault : 6     --> 金庫\n","# index of \"bank\" robber  : 10  --> 搶匪\n","# index of \"river bank\" : 19    --> 河岸\n","\n","print('Vector similarity for  *similar*  meanings:  %.2f' % same_bank)\n","print('Vector similarity for *different* meanings:  %.2f' % diff_bank)"],"metadata":{"id":"2lTQ-XRPqXQT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136131566,"user_tz":-480,"elapsed":403,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"1aa6c629-668e-4387-d091-803b61e1e3cf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([768])\n","Vector similarity for  *similar*  meanings:  0.94\n","Vector similarity for *different* meanings:  0.69\n"]}]},{"cell_type":"markdown","source":["## 2) 嘗試中文"],"metadata":{"id":"vYyfQIrLrY6N"}},{"cell_type":"code","source":["# Load pre-trained model (weights)\n","# Whether the model returns all hidden-states.\n","\n","USE_PRETRAINED = \"bert-base-chinese\"\n","# Load pre-trained model tokenizer (vocabulary)\n","tokenizer = BertTokenizer.from_pretrained(USE_PRETRAINED)\n","model = BertModel.from_pretrained(USE_PRETRAINED, output_hidden_states = True )\n","#print(model)\n","\n","# 以下面這些字詞輸入，會看到什麼\n","# Define a new example sentence with multiple meanings of the word \"bank\"\n","str_text_chinese = \"這傢伙真愛現，愛約不約，不知道有誰愛他。\"\n","\n","\n","# Add the special tokens.\n","marked_text = \"[CLS] \" + str_text_chinese + \" [SEP]\"\n","\n","# Split the sentence into tokens.\n","tokenized_text = tokenizer.tokenize(marked_text)\n","\n","# Map the token strings to their vocabulary indeces.\n","indexed_tokens = tokenizer.convert_tokens_to_ids(tokenized_text)\n","\n","# Display the words with their indeces.\n","for tup in zip(tokenized_text, indexed_tokens):\n","    print('{:<12} {:>6,}'.format(tup[0], tup[1]))\n","\n","# Mark each of the 22 tokens as belonging to sentence \"1\".\n","segments_ids = [1] * len(tokenized_text)\n","\n","print (segments_ids)\n"],"metadata":{"id":"VLphpk_yryt1","colab":{"base_uri":"https://localhost:8080/","height":629,"referenced_widgets":["32f335bb67e545cb9f085db7fdaaa798","c9df54ca00f147df8c79415644c99def","c08061bcaac14fcaa8bf52245883bd32","f682112ebad54104991eb7b0120a6516","626316d8518b4ffeb615d27acdff2f30","3d93f65256ab44d4ae61a66c1ecb8d54","0d14c7b22b2a432889e145e2cb3a2f2f","da7b4a48901f42c7b741318705dcdebf","a4e3e378641e4cedb2ed67ba80a7b44b","8ff28fc16c804f53ab90510c39f29a6c","4114c413f50e4b55add01464320e7151","3ecf9d6773df4c04b8c3d125d1594550","494a7efd8f3649cd9cd6567cb99c9812","9000b04c2f9141d3ac994aa1e475801b","2627693412c24da6ade2fe26409c370d","c2a1e84527a746d18be72230685fa282","5517cd26b139435abf0109f27667ee58","6dc4566fbcf54e84b6d81cb03f37fe73","4cf98f1113cd41a1ae50dcf225c230ef","135073c6694d4e33b728c603646a9441","4b78006bcc104fecbba1aa96cc0f043d","8b3fd42ab5824e9b955e5f2b62a06356","d0ecff3ed2684b35924b24ad5a511959","6b472daf013b40db8460dd1eb38a8da3","c78dd58180444e4bb8d2b18942436cac","c92a9d2cc76a455197bb9b0acd57a62d","91bfd6b5d3b74571a8bc91615a2de3ee","937fd255686049bebf07b94bb3c16c79","2c67f8b0fba7415598b34ccf080c0424","6a0dcdfa987f43d49c8585a1a4542b96","9ee55d6b92a44b238d243c04bfb05347","5cfb5b7902174ba7a78df2a43981b089","fc4d29cb1a094078aec62045774c60a7","d3435f0ba0b1461cab152863c0588715","d95bd162459744f7b6d2417ae6702693","bc38fc2aa9b940c48eef66b509e8d142","3586ae009344493aadb98eb91a78ba21","4fe9d4cc3d29457199639979f202df1a","8bca5fd8f55e451e992878e7dc08247e","94f97a6bd76b47ef8e30c9f8aeb87116","34d3d25536d241ca99ac45b21daf0b8b","f980bc18cd8b4c2eb13555e6c23c1e9c","2a9da7f0b0394d3ab473bb16dbc06be2","1955ec15145240849b8f3a13a3942b02"]},"executionInfo":{"status":"ok","timestamp":1684136137040,"user_tz":-480,"elapsed":5480,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"66a58b36-8ee1-481d-b58c-c63cebcd025f"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/110k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"32f335bb67e545cb9f085db7fdaaa798"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3ecf9d6773df4c04b8c3d125d1594550"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/624 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d0ecff3ed2684b35924b24ad5a511959"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/412M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d3435f0ba0b1461cab152863c0588715"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-chinese were not used when initializing BertModel: ['cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"stream","name":"stdout","text":["[CLS]           101\n","這             6,857\n","傢               993\n","伙               832\n","真             4,696\n","愛             2,695\n","現             4,412\n","，             8,024\n","愛             2,695\n","約             5,147\n","不               679\n","約             5,147\n","，             8,024\n","不               679\n","知             4,761\n","道             6,887\n","有             3,300\n","誰             6,306\n","愛             2,695\n","他               800\n","。               511\n","[SEP]           102\n","[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n"]}]},{"cell_type":"code","source":["# Convert inputs to PyTorch tensors\n","tokens_tensor = torch.tensor([indexed_tokens])\n","segments_tensors = torch.tensor([segments_ids])\n","\n","# using get_bert_embeddings()\n","the_emb = get_bert_embeddings(tokens_tensor, segments_tensors, model)\n","\n","print('First 5 vector values for each instance of \"愛\".')\n","print('')\n","print(\"愛現   \", str(the_emb[5][:5]))\n","print(\"愛約  \", str(the_emb[8][:5]))\n","print(\"愛他   \", str(the_emb[18][:5]))"],"metadata":{"id":"BtOqplLpsnXP","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136137590,"user_tz":-480,"elapsed":553,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"40a2817c-fab5-463b-f25b-3f277eced895"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([22, 13, 768])\n","First 5 vector values for each instance of \"愛\".\n","\n","愛現    tensor([[ 0.1200, -0.4850, -0.2641,  ..., -0.4633,  0.5066,  0.2273],\n","        [ 1.2661, -0.2052, -0.0158,  ..., -0.5633,  0.3113,  0.6227],\n","        [ 1.0843, -0.1925, -0.1454,  ...,  0.0471, -0.2889,  0.2105],\n","        [ 0.8375,  0.0599,  0.2892,  ...,  0.4348, -0.0682,  0.1748],\n","        [ 0.7849, -0.1868, -0.3747,  ..., -0.0384,  0.2568,  0.8115]])\n","愛約   tensor([[ 0.5381, -0.4625, -0.6474,  ..., -0.6172,  0.6440,  0.1943],\n","        [ 1.9364, -0.1076, -0.1997,  ..., -0.8035,  0.4019,  0.8256],\n","        [ 1.7771, -0.1010, -0.4763,  ...,  0.1899, -0.1975,  0.3947],\n","        [ 1.6639, -0.0035, -0.1695,  ...,  0.5612, -0.0541, -0.1194],\n","        [ 1.4018, -0.5933, -0.3402,  ...,  0.7983,  0.0252, -0.1438]])\n","愛他    tensor([[ 0.7865, -0.5794, -0.4935,  ..., -0.0862,  0.4953,  0.1259],\n","        [ 1.8520, -0.2321, -0.2969,  ..., -0.3614,  0.0844,  0.5562],\n","        [ 1.1981, -0.4746, -0.4307,  ...,  0.5211, -0.6408, -0.2158],\n","        [ 0.9205, -0.3833, -0.1917,  ...,  0.6006,  0.0221, -0.7972],\n","        [ 0.9519, -0.7508, -0.1873,  ...,  0.8536,  0.3199, -0.5546]])\n"]}]},{"cell_type":"code","source":["from scipy.spatial.distance import cosine\n","\n","# Stores the token vectors, with shape [22 x 768]\n","token_vecs_sum = []\n","\n","# `token_embeddings` is a [22 x 12 x 768] tensor.\n","\n","# For each token in the sentence...\n","for token in the_emb:\n","\n","    # `token` is a [12 x 768] tensor\n","\n","    # Sum the vectors from the last four layers.\n","    sum_vec = torch.sum(token[-4:], dim=0)\n","    \n","    # Use `sum_vec` to represent `token`.\n","    token_vecs_sum.append(sum_vec)\n","\n","\n","# Calculate the cosine similarity between the word bank \n","# in \"bank robber\" vs \"river bank\" (different meanings).\n","diff_bank = 1 - cosine(token_vecs_sum[8], token_vecs_sum[5])\n","\n","# Calculate the cosine similarity between the word bank\n","# in \"bank robber\" vs \"bank vault\" (same meaning).\n","same_bank = 1 - cosine(token_vecs_sum[18], token_vecs_sum[5])\n","\n","# index of 愛現 : 5 \n","# index of 愛約 : 8 \n","# index of 愛他 : 18\n","\n","print('Vector similarity for  *similar*  meanings:  %.2f' % same_bank)\n","print('Vector similarity for *different* meanings:  %.2f' % diff_bank)"],"metadata":{"id":"gTVe5gp3tNcC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684136137590,"user_tz":-480,"elapsed":4,"user":{"displayName":"林柏亦","userId":"18385432373658038035"}},"outputId":"1f307e4e-8bc1-483d-d5bc-8971a998e6dd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Vector similarity for  *similar*  meanings:  0.67\n","Vector similarity for *different* meanings:  0.68\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"mHwenN1XU79Q"},"execution_count":null,"outputs":[]}]}